var T=Object.defineProperty;var X=(w,y,k)=>y in w?T(w,y,{enumerable:!0,configurable:!0,writable:!0,value:k}):w[y]=k;var _=(w,y,k)=>X(w,typeof y!="symbol"?y+"":y,k);(function(w){typeof define=="function"&&define.amd?define(w):w()})(function(){"use strict";const w='.ideabosque-ai-iframe{border-radius:20px;overflow:hidden;border:0}.ideabosque-ai-drawer{height:0;width:0;position:fixed;padding:0;bottom:0!important;right:unset;top:unset;left:unset;border:0;box-sizing:border-box;overflow:hidden;margin:0;background-color:transparent!important}.ideabosque-ai-drawer-body{position:fixed;left:0;top:0;bottom:0;z-index:999;transform:translateX(-100%);background:#faf7f0;border-right:1px solid #faf7f0}.ideabosque-ai-drawer-body .ideabosque-ai-iframe{height:100%!important;border-radius:0!important}.ideabosque-ai-drawer-body{transition:all .5s ease-in-out}.ideabosque-ai-drawer-switch{transition:all .3s ease}.ideabosque-ai-drawer-switch{position:fixed;bottom:104px;left:0;background:#3b6351;background:56px;height:56px;width:56px;border-radius:50%;border:2px solid #F3F4F6;box-shadow:0px 4px 12px 0px rgba(0,0,0,0.08);padding:4px;cursor:pointer;transform:translateX(24px);opacity:1;z-index:0}.ideabosque-ai-window-close{width:32px;height:32px;z-index:2;position:absolute;right:16px;top:16px;background-image:url(https://shopify-airobot-entry.pages.dev/close.svg?v=1.0);background-size:cover;background-repeat:no-repeat;background-position:center center;cursor:pointer}.ideabosque-ai-drawer-switch div{width:100%;height:100%;border-radius:50%;background-image:url(https://shopify-airobot-entry.pages.dev/avatar.svg?v=1.0);background-size:cover;background-repeat:no-repeat;background-position:center center}.ideabosque-ai-drawer-switch div::before{content:"";opacity:0}.ideabosque-ai-drawer-open .ideabosque-ai-drawer-body{transform:translateX(0)}.ideabosque-ai-drawer-open .ideabosque-ai-drawer-switch{visibility:hidden;transform:translateX(-100%);opacity:0}@media(max-width:640px){.ideabosque-ai-iframe{margin-bottom:24px;width:100%!important;height:580px!important}}@media(max-width:980px){.ideabosque-ai-iframe{margin-bottom:24px}}';function y(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var k={exports:{}},O;function L(){return O||(O=1,function(s){var e=Object.prototype.hasOwnProperty,t="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(t=!1));function p(d,n,r){this.fn=d,this.context=n,this.once=r||!1}function g(d,n,r,i,h){if(typeof r!="function")throw new TypeError("The listener must be a function");var f=new p(r,i||d,h),u=t?t+n:n;return d._events[u]?d._events[u].fn?d._events[u]=[d._events[u],f]:d._events[u].push(f):(d._events[u]=f,d._eventsCount++),d}function x(d,n){--d._eventsCount===0?d._events=new a:delete d._events[n]}function c(){this._events=new a,this._eventsCount=0}c.prototype.eventNames=function(){var n=[],r,i;if(this._eventsCount===0)return n;for(i in r=this._events)e.call(r,i)&&n.push(t?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(r)):n},c.prototype.listeners=function(n){var r=t?t+n:n,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var h=0,f=i.length,u=new Array(f);h<f;h++)u[h]=i[h].fn;return u},c.prototype.listenerCount=function(n){var r=t?t+n:n,i=this._events[r];return i?i.fn?1:i.length:0},c.prototype.emit=function(n,r,i,h,f,u){var b=t?t+n:n;if(!this._events[b])return!1;var o=this._events[b],v=arguments.length,q,l;if(o.fn){switch(o.once&&this.removeListener(n,o.fn,void 0,!0),v){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,r),!0;case 3:return o.fn.call(o.context,r,i),!0;case 4:return o.fn.call(o.context,r,i,h),!0;case 5:return o.fn.call(o.context,r,i,h,f),!0;case 6:return o.fn.call(o.context,r,i,h,f,u),!0}for(l=1,q=new Array(v-1);l<v;l++)q[l-1]=arguments[l];o.fn.apply(o.context,q)}else{var j=o.length,E;for(l=0;l<j;l++)switch(o[l].once&&this.removeListener(n,o[l].fn,void 0,!0),v){case 1:o[l].fn.call(o[l].context);break;case 2:o[l].fn.call(o[l].context,r);break;case 3:o[l].fn.call(o[l].context,r,i);break;case 4:o[l].fn.call(o[l].context,r,i,h);break;default:if(!q)for(E=1,q=new Array(v-1);E<v;E++)q[E-1]=arguments[E];o[l].fn.apply(o[l].context,q)}}return!0},c.prototype.on=function(n,r,i){return g(this,n,r,i,!1)},c.prototype.once=function(n,r,i){return g(this,n,r,i,!0)},c.prototype.removeListener=function(n,r,i,h){var f=t?t+n:n;if(!this._events[f])return this;if(!r)return x(this,f),this;var u=this._events[f];if(u.fn)u.fn===r&&(!h||u.once)&&(!i||u.context===i)&&x(this,f);else{for(var b=0,o=[],v=u.length;b<v;b++)(u[b].fn!==r||h&&!u[b].once||i&&u[b].context!==i)&&o.push(u[b]);o.length?this._events[f]=o.length===1?o[0]:o:x(this,f)}return this},c.prototype.removeAllListeners=function(n){var r;return n?(r=t?t+n:n,this._events[r]&&x(this,r)):(this._events=new a,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,s.exports=c}(k)),k.exports}var A=L();const N=y(A),m="ideabosque";class P{constructor(e){_(this,"iframe");_(this,"event",new N);_(this,"init",()=>{window.addEventListener("message",this.onMessage)});_(this,"sendMessage",(e,t)=>{const a=JSON.stringify(t),p=`${m}-${e}`;this.win.postMessage({type:p,data:a},"*")});_(this,"on",(e,t)=>(this.event.on(e,t),this.event));_(this,"onMessage",e=>{var p;const t=e.data.type;let a=e.data.data;if((p=t==null?void 0:t.includes)!=null&&p.call(t,m)){const g=t.replace(`${m}-`,"");a&&(a=JSON.parse(a)),this.event.emit(g,a)}});this.iframe=e,this.init()}get win(){return this.iframe.contentWindow}}const S=s=>{const e=s.getAttribute("width")||640,t=s.getAttribute("height")||600;return{width:e,height:t}},$=()=>new Promise((s,e)=>{window.navigator.geolocation.getCurrentPosition(a=>{s(a.coords.toJSON())},async a=>{e(a)})}),z={stringify:s=>Object.keys(s).map(t=>`${t}=${s[t]}`).join("&")};let C="https://shopify-ai-chat.pages.dev";const I=()=>{const s=document.querySelector("head"),e=document.createElement("style");e.setAttribute("data-role",`${m}-style`),e.innerHTML=w,s==null||s.appendChild(e)},M=()=>{const s=`script[data-role='${m}-ai']`;return document.querySelector(s)},B=(s,e)=>{I();const t=S(e),a=document.createElement("iframe"),p=e.getAttribute("iframe-url"),g=e.getAttribute("agent"),x=e.getAttribute("userId"),c=e.getAttribute("question"),d=e.getAttribute("endpoint-id"),n=e.getAttribute("coordination"),r=e.getAttribute("agent-name")||"";p&&(C=p);const i=z.stringify({agent:g,userId:x,question:c,agentName:r,endpointId:d,coordination:n,mode:"preview"});return a.src=`${C}?${i}`,a.className=`${m}-ai-iframe`,a.style.width=t.width+"px",a.style.height=t.height+"px",a.setAttribute("frameborder","0"),a.setAttribute("allow","geolocation"),s.appendChild(a),a},F=s=>{const e=new P(s);e.on("get-position",async()=>{let t=!0,a={};try{a=await $()}catch{t=!1}e.sendMessage("get-position",{...a,success:t})})};(()=>{let s=!1,e=null;const t=M(),a=(t==null?void 0:t.getAttribute("open-type"))||"screen",p=c=>{!c||s||(F(B(c,t)),s=!0)},g=()=>{const c=document.createElement("div"),d=document.createElement("div");return c.className=`${m}-ai-window-close`,c.appendChild(d),c},x=(c=!0)=>{var v;const d=document.body;e=document.createElement("div");const n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),h=g(),f=`${m}-ai-drawer`,u=`${m}-ai-drawer-body`,b=`${m}-ai-drawer-switch`,o=`${m}-ai-drawer-open`;e.className=f,e.setAttribute("popover","manual"),n.className=u,r.className=b,e.appendChild(n),e.appendChild(r),n.appendChild(h),r.appendChild(i),d.appendChild(e),p(n),c&&((v=e==null?void 0:e.showPopover)==null||v.call(e),e.classList.add(o)),r.addEventListener("click",()=>{e==null||e.classList.toggle(o)}),h.addEventListener("click",()=>{e==null||e.classList.toggle(o)})};if(a==="screen"){const c=t==null?void 0:t.getAttribute("selector");c&&(e=document.querySelector(c),p(e))}window.initIdeabosqueAi=(c=!0)=>{a!=="drawer"||s||x(c)},window.removeIdeabosqueAi=()=>{a==="drawer"&&e&&s&&(document.body.removeChild(e),s=!1)}})()});
