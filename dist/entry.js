var F=Object.defineProperty;var J=(b,w,x)=>w in b?F(b,w,{enumerable:!0,configurable:!0,writable:!0,value:x}):b[w]=x;var O=(b,w,x)=>J(b,typeof w!="symbol"?w+"":w,x);(function(b){typeof define=="function"&&define.amd?define(b):b()})(function(){"use strict";const b='.ideabosque-ai-iframe{border-radius:20px;background:#fff;overflow:hidden;border:0;box-shadow:0 -4px 16px 0 rgba(0,0,0,0.25)}.ideabosque-ai-drawer{height:0;width:0;position:fixed;padding:0;bottom:0!important;right:0!important;top:unset;left:unset;border:0;box-sizing:border-box;overflow:hidden;margin:0;background-color:transparent!important}.ideabosque-ai-drawer-body{position:fixed;right:0;top:0;bottom:0;z-index:999;transform:translateX(100%);transition:all .3s ease-in-out}.ideabosque-ai-drawer-body .ideabosque-ai-iframe{height:100%!important;border-radius:0!important}.ideabosque-ai-drawer-switch{position:absolute;top:50%;background:#3b6351;transform:translateY(-50%) translateX(-100%);cursor:pointer;padding:16px 6px;border-top-left-radius:8px;border-bottom-left-radius:8px;display:flex;flex-direction:column;gap:8px}.ideabosque-ai-drawer-switch::after{content:"";width:14px;height:14px;display:block;background-image:url(https://airobot-entry.pages.dev/arrow.png?v=1.0);background-size:cover;background-repeat:no-repeat;background-position:center center;transform:rotate(180deg);transition:all .2s linear}.ideabosque-ai-drawer-switch div{writing-mode:vertical-rl;text-align:center;font-size:12px;color:#fff;font-weight:550}.ideabosque-ai-drawer-open .ideabosque-ai-drawer-body{transform:translateX(0)}.ideabosque-ai-drawer-open .ideabosque-ai-drawer-switch::after{transform:rotate(0)}@media(max-width:640px){.ideabosque-ai-iframe{margin-bottom:24px;width:100%!important;height:580px!important}}@media(max-width:980px){.ideabosque-ai-iframe{margin-bottom:24px}}';function w(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var x={exports:{}},E;function L(){return E||(E=1,function(a){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function p(c,n,o){this.fn=c,this.context=n,this.once=o||!1}function g(c,n,o,i,m){if(typeof o!="function")throw new TypeError("The listener must be a function");var f=new p(o,i||c,m),l=t?t+n:n;return c._events[l]?c._events[l].fn?c._events[l]=[c._events[l],f]:c._events[l].push(f):(c._events[l]=f,c._eventsCount++),c}function h(c,n){--c._eventsCount===0?c._events=new s:delete c._events[n]}function d(){this._events=new s,this._eventsCount=0}d.prototype.eventNames=function(){var n=[],o,i;if(this._eventsCount===0)return n;for(i in o=this._events)e.call(o,i)&&n.push(t?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(o)):n},d.prototype.listeners=function(n){var o=t?t+n:n,i=this._events[o];if(!i)return[];if(i.fn)return[i.fn];for(var m=0,f=i.length,l=new Array(f);m<f;m++)l[m]=i[m].fn;return l},d.prototype.listenerCount=function(n){var o=t?t+n:n,i=this._events[o];return i?i.fn?1:i.length:0},d.prototype.emit=function(n,o,i,m,f,l){var y=t?t+n:n;if(!this._events[y])return!1;var r=this._events[y],k=arguments.length,_,u;if(r.fn){switch(r.once&&this.removeListener(n,r.fn,void 0,!0),k){case 1:return r.fn.call(r.context),!0;case 2:return r.fn.call(r.context,o),!0;case 3:return r.fn.call(r.context,o,i),!0;case 4:return r.fn.call(r.context,o,i,m),!0;case 5:return r.fn.call(r.context,o,i,m,f),!0;case 6:return r.fn.call(r.context,o,i,m,f,l),!0}for(u=1,_=new Array(k-1);u<k;u++)_[u-1]=arguments[u];r.fn.apply(r.context,_)}else{var B=r.length,q;for(u=0;u<B;u++)switch(r[u].once&&this.removeListener(n,r[u].fn,void 0,!0),k){case 1:r[u].fn.call(r[u].context);break;case 2:r[u].fn.call(r[u].context,o);break;case 3:r[u].fn.call(r[u].context,o,i);break;case 4:r[u].fn.call(r[u].context,o,i,m);break;default:if(!_)for(q=1,_=new Array(k-1);q<k;q++)_[q-1]=arguments[q];r[u].fn.apply(r[u].context,_)}}return!0},d.prototype.on=function(n,o,i){return g(this,n,o,i,!1)},d.prototype.once=function(n,o,i){return g(this,n,o,i,!0)},d.prototype.removeListener=function(n,o,i,m){var f=t?t+n:n;if(!this._events[f])return this;if(!o)return h(this,f),this;var l=this._events[f];if(l.fn)l.fn===o&&(!m||l.once)&&(!i||l.context===i)&&h(this,f);else{for(var y=0,r=[],k=l.length;y<k;y++)(l[y].fn!==o||m&&!l[y].once||i&&l[y].context!==i)&&r.push(l[y]);r.length?this._events[f]=r.length===1?r[0]:r:h(this,f)}return this},d.prototype.removeAllListeners=function(n){var o;return n?(o=t?t+n:n,this._events[o]&&h(this,o)):(this._events=new s,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=t,d.EventEmitter=d,a.exports=d}(x)),x.exports}var A=L();const N=w(A),v="ideabosque";class P{constructor(e){O(this,"iframe");O(this,"event",new N);O(this,"init",()=>{window.addEventListener("message",this.onMessage)});O(this,"sendMessage",(e,t)=>{const s=JSON.stringify(t),p=`${v}-${e}`;this.win.postMessage({type:p,data:s},"*")});O(this,"on",(e,t)=>(this.event.on(e,t),this.event));O(this,"onMessage",e=>{var p;const t=e.data.type;let s=e.data.data;if((p=t==null?void 0:t.includes)!=null&&p.call(t,v)){const g=t.replace(`${v}-`,"");s&&(s=JSON.parse(s)),this.event.emit(g,s)}});this.iframe=e,this.init()}get win(){return this.iframe.contentWindow}}const S=a=>{const e=a.getAttribute("width")||640,t=a.getAttribute("height")||600;return{width:e,height:t}},$=()=>new Promise((a,e)=>{window.navigator.geolocation.getCurrentPosition(s=>{a(s.coords.toJSON())},async s=>{e(s)})}),M={stringify:a=>Object.keys(a).map(t=>`${t}=${a[t]}`).join("&")};let C="https://ideabosque-ai-chat.pages.dev";const z=()=>{const a=document.querySelector("head"),e=document.createElement("style");e.setAttribute("data-role",`${v}-style`),e.innerHTML=b,a==null||a.appendChild(e)},I=()=>{const a=`script[data-role='${v}-ai']`;return document.querySelector(a)},T=(a,e)=>{z();const t=S(e),s=document.createElement("iframe"),p=e.getAttribute("iframe-url"),g=e.getAttribute("coordination"),h=e.getAttribute("agent"),d=e.getAttribute("endpoint-id");p&&(C=p);const c=M.stringify({mode:"preview",coordination:g,agent:h,endpointId:d});return s.src=`${C}?${c}`,s.className=`${v}-ai-iframe`,s.style.width=t.width+"px",s.style.height=t.height+"px",s.setAttribute("frameborder","0"),s.setAttribute("allow","geolocation"),a.appendChild(s),s},j=a=>{const e=new P(a);e.on("get-position",async()=>{let t=!0,s={};try{s=await $()}catch{t=!1}e.sendMessage("get-position",{...s,success:t})})};(()=>{let a=!1,e=null;const t=I(),s=(t==null?void 0:t.getAttribute("open-type"))||"screen",p=h=>{!h||a||(j(T(h,t)),a=!0)},g=(h=!0)=>{var l;e=document.createElement("div");const d=document.createElement("div"),c=document.createElement("div"),n=document.createElement("div"),o=`${v}-ai-drawer`,i=`${v}-ai-drawer-body`,m=`${v}-ai-drawer-switch`,f=`${v}-ai-drawer-open`;e.className=o,e.setAttribute("popover","manual"),d.className=i,c.className=m,e.appendChild(d),d.appendChild(c),c.appendChild(n),n.innerHTML="Chat Agent B2B",document.body.appendChild(e),p(d),h&&((l=e==null?void 0:e.showPopover)==null||l.call(e),e.classList.add(f)),c.addEventListener("click",()=>{e==null||e.classList.toggle(f)})};if(s==="screen"){const h=t==null?void 0:t.getAttribute("selector");h&&(e=document.querySelector(h),p(e))}window.initIdeabosqueAi=(h=!0)=>{s!=="drawer"||a||g(h)},window.removeIdeabosqueAi=()=>{s==="drawer"&&e&&document.body.removeChild(e)}})()});
